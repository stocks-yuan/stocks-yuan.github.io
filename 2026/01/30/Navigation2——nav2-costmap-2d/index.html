<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Navigation2â€”â€”nav2_costmap_2d" />
    <meta name="hexo-theme-A4" content="v2.0.0" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.jpg">
    <title>Stocks</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


   
        
<link rel="stylesheet" href="/css/custom.css">

    
    <link rel='stylesheet' href='https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkai/dist/LXGWWenKai-Regular/result.css' /> 
<meta name="generator" content="Hexo 8.1.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
    
    

    
    



    
        <style>
            .paper-main{
                max-width:  1200px;
            }
        </style>

    
    




    
    
    <style>
        body {
            background-image: url(/img/bg3.png);
            background-attachment: fixed;  /* èƒŒæ™¯å›ºå®šï¼Œä¸éšé¡µé¢æ»šåŠ¨ */
            background-repeat: no-repeat;  /* é˜²æ­¢èƒŒæ™¯å›¾ç‰‡é‡å¤ */
            background-size: cover;       /* èƒŒæ™¯è‡ªé€‚åº”å¤§å°ï¼Œè¦†ç›–æ•´ä¸ªèƒŒæ™¯ */
            background-position: center;   /* èƒŒæ™¯å±…ä¸­æ˜¾ç¤º */
        }
        .paper {
            background-image: url(/img/bg3.png);
            background-attachment: fixed;  /* èƒŒæ™¯å›ºå®šï¼Œä¸éšé¡µé¢æ»šåŠ¨ */
            background-repeat: no-repeat;  /* é˜²æ­¢èƒŒæ™¯å›¾ç‰‡é‡å¤ */
            background-size: cover;       /* èƒŒæ™¯è‡ªé€‚åº”å¤§å°ï¼Œè¦†ç›–æ•´ä¸ªèƒŒæ™¯ */
            background-position: center;   /* èƒŒæ™¯å±…ä¸­æ˜¾ç¤º */
        }  
    </style>



    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            
                <div class="left-toc-container">
                    <nav id="toc" class="bs-docs-sidebar"></nav>
                </div>
            
        
        <div class="paper">

            

            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
                transition: transform 0.3s ease-in-out; 
                border-radius: 50%; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/favicon.jpg" 
        />
        <div class="header-content">
            <a class="logo" href="/">Stocks</a> 
            <span class="description">åµŒå…¥å¼ç³»ç»Ÿå¼€å‘ | æœºå™¨äººç®—æ³•</span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸ  é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ“Œæ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ“åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸŒŸå…³äº</a></li>
            
        
    </ul>
</div>

                    
                    

                    
                    

                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    Navigation2â€”â€”nav2_costmap_2d
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>æœ€è¿‘æ›´æ–°ï¼š2026-02-02</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>å­—æ•°æ€»è®¡ï¼š1.2k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>é˜…è¯»ä¼°æ—¶ï¼š5åˆ†é’Ÿ</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv"></span>æ¬¡
                    </span>
                
            </div>
    

    <div class="post-md">
        
        <div class=".article-gallery"><h3 id="nav2_costmap_2d-åŠŸèƒ½åŒ…ä¸»è¦åŠŸèƒ½åˆ†æ">nav2_costmap_2d åŠŸèƒ½åŒ…ä¸»è¦åŠŸèƒ½åˆ†æ</h3>
<p><code>nav2_costmap_2d</code> åŠŸèƒ½åŒ…æ˜¯ Navigation2 ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ„å»ºå’Œç»´æŠ¤æœºå™¨äººå¯¼èˆªæ‰€éœ€çš„ 2D ä»£ä»·åœ°å›¾ã€‚</p>
<h4 id="æ ¸å¿ƒæ¶æ„æ¦‚è¿°">1. æ ¸å¿ƒæ¶æ„æ¦‚è¿°</h4>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚                    Costmap2DROS                         â”‚</span><br><span class="line">â”‚  (ROS2 å°è£…å±‚ - LifecycleNode)                          â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚                   LayeredCostmap                        â”‚</span><br><span class="line">â”‚  (åˆ†å±‚ä»£ä»·åœ°å›¾ç®¡ç†å™¨)                                    â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚ StaticLayer â”‚ ObstacleLayer â”‚ InflationLayer â”‚ ...    â”‚</span><br><span class="line">â”‚ (é™æ€å±‚)    â”‚ (éšœç¢ç‰©å±‚)     â”‚ (è†¨èƒ€å±‚)        â”‚        â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚                     Costmap2D                           â”‚</span><br><span class="line">â”‚  (åº•å±‚2Dä»£ä»·åœ°å›¾æ•°æ®ç»“æ„)                                â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></tbody></table></figure>
<h4 id="åœ¨-plannerserver-ä¸­çš„ä½¿ç”¨">2. åœ¨ PlannerServer ä¸­çš„ä½¿ç”¨</h4>
<p>åœ¨ <a href="nav2_planner/src/planner_server.cpp">planner_server.cpp</a> ä¸­ï¼Œ<code>costmap_ros_</code> çš„ä½¿ç”¨æµç¨‹å±•ç¤ºäº†ä»£ä»·åœ°å›¾å¦‚ä½•ä¸ºè·¯å¾„è§„åˆ’æœåŠ¡ã€‚</p>
<h5 id="æ„é€ å‡½æ•°ä¸­åˆ›å»º-costmap2dros">2.1 æ„é€ å‡½æ•°ä¸­åˆ›å»º Costmap2DROS</h5>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PlannerServer::<span class="built_in">PlannerServer</span>()</span><br><span class="line">: nav2_util::<span class="built_in">LifecycleNode</span>(<span class="string">"nav2_planner"</span>, <span class="string">""</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="built_in">gp_loader_</span>(<span class="string">"nav2_core"</span>, <span class="string">"nav2_core::GlobalPlanner"</span>),</span><br><span class="line">  default_ids_{<span class="string">"GridBased"</span>},</span><br><span class="line">  default_types_{<span class="string">"nav2_navfn_planner/NavfnPlanner"</span>},</span><br><span class="line">  <span class="built_in">costmap_</span>(<span class="literal">nullptr</span>)</span><br><span class="line">{</span><br><span class="line">  <span class="comment">// åˆ›å»ºå…¨å±€ä»£ä»·åœ°å›¾èŠ‚ç‚¹</span></span><br><span class="line">  costmap_ros_ = std::<span class="built_in">make_shared</span>&lt;nav2_costmap_2d::Costmap2DROS&gt;(</span><br><span class="line">    <span class="string">"global_costmap"</span>, std::string{<span class="built_in">get_namespace</span>()}, <span class="string">"global_costmap"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­è¿è¡Œä»£ä»·åœ°å›¾èŠ‚ç‚¹</span></span><br><span class="line">  costmap_thread_ = std::<span class="built_in">make_unique</span>&lt;nav2_util::NodeThread&gt;(costmap_ros_);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h5 id="é…ç½®é˜¶æ®µè·å–ä»£ä»·åœ°å›¾">2.2 é…ç½®é˜¶æ®µè·å–ä»£ä»·åœ°å›¾</h5>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">nav2_util::CallbackReturn</span></span><br><span class="line"><span class="function"><span class="title">PlannerServer::on_configure</span><span class="params">(<span class="type">const</span> rclcpp_lifecycle::State &amp; <span class="comment">/*state*/</span>)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="comment">// é…ç½®ä»£ä»·åœ°å›¾</span></span><br><span class="line">  costmap_ros_-&gt;<span class="built_in">configure</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–åº•å±‚ Costmap2D æŒ‡é’ˆ</span></span><br><span class="line">  costmap_ = costmap_ros_-&gt;<span class="built_in">getCostmap</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å– TF buffer ç”¨äºåæ ‡å˜æ¢</span></span><br><span class="line">  tf_ = costmap_ros_-&gt;<span class="built_in">getTfBuffer</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å°†ä»£ä»·åœ°å›¾ä¼ é€’ç»™è§„åˆ’å™¨æ’ä»¶</span></span><br><span class="line">  planner-&gt;<span class="built_in">configure</span>(node, planner_ids_[i], tf_, costmap_ros_);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="æ ¸å¿ƒç±»åŠŸèƒ½è¯¦è§£">3. æ ¸å¿ƒç±»åŠŸèƒ½è¯¦è§£</h4>
<h5 id="costmap2dros---ros2-å°è£…å±‚">3.1 Costmap2DROS - ROS2 å°è£…å±‚</h5>
<p><code>Costmap2DROS</code> æ˜¯ä»£ä»·åœ°å›¾çš„ ROS2 æ¥å£å°è£…ï¼Œç»§æ‰¿è‡ª <code>LifecycleNode</code>ï¼Œå®šä¹‰åœ¨ <a href="nav2_costmap_2d/include/nav2_costmap_2d/costmap_2d_ros.hpp">costmap_2d_ros.hpp</a>ï¼š</p>
<p><strong>ä¸»è¦èŒè´£ï¼š</strong></p>
<ul>
<li>ç®¡ç†ä»£ä»·åœ°å›¾çš„ç”Ÿå‘½å‘¨æœŸï¼ˆé…ç½®ã€æ¿€æ´»ã€å¤±æ´»ã€æ¸…ç†ï¼‰</li>
<li>å¤„ç† ROS2 è¯é¢˜è®¢é˜…ï¼ˆä¼ æ„Ÿå™¨æ•°æ®ã€æœºå™¨äººè¶³è¿¹ï¼‰</li>
<li>æä¾› TF åæ ‡å˜æ¢æœåŠ¡</li>
<li>å‘å¸ƒä»£ä»·åœ°å›¾å¯è§†åŒ–ä¿¡æ¯</li>
</ul>
<p><strong>æ ¸å¿ƒæ¥å£ï¼š</strong>
</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Costmap2DROS</span> : <span class="keyword">public</span> nav2_util::LifecycleNode</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="comment">// è·å–åº•å±‚ä»£ä»·åœ°å›¾</span></span><br><span class="line">  <span class="function">Costmap2D * <span class="title">getCostmap</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–æœºå™¨äººå½“å‰ä½å§¿</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">getRobotPose</span><span class="params">(geometry_msgs::msg::PoseStamped &amp; global_pose)</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å– TF buffer</span></span><br><span class="line">  <span class="function">std::shared_ptr&lt;tf2_ros::Buffer&gt; <span class="title">getTfBuffer</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–åˆ†å±‚ä»£ä»·åœ°å›¾</span></span><br><span class="line">  <span class="function">LayeredCostmap * <span class="title">getLayeredCostmap</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ç”Ÿå‘½å‘¨æœŸç®¡ç†</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">start</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pause</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">resume</span><span class="params">()</span></span>;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<h5 id="costmap2d---åº•å±‚æ•°æ®ç»“æ„">3.2 Costmap2D - åº•å±‚æ•°æ®ç»“æ„</h5>
<p><code>Costmap2D</code> æ˜¯å®é™…å­˜å‚¨ä»£ä»·å€¼çš„æ•°æ®ç»“æ„ï¼Œå®šä¹‰åœ¨ <a href="nav2_costmap_2d/include/nav2_costmap_2d/costmap_2d.hpp">costmap_2d.hpp</a>ï¼š</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>
</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Costmap2D</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="comment">// è·å–/è®¾ç½®å•å…ƒæ ¼ä»£ä»·å€¼</span></span><br><span class="line">  <span class="function"><span class="type">unsigned</span> <span class="type">char</span> <span class="title">getCost</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> mx, <span class="type">unsigned</span> <span class="type">int</span> my)</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setCost</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> mx, <span class="type">unsigned</span> <span class="type">int</span> my, <span class="type">unsigned</span> <span class="type">char</span> cost)</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä¸–ç•Œåæ ‡ &lt;-&gt; åœ°å›¾åæ ‡è½¬æ¢</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">worldToMap</span><span class="params">(<span class="type">double</span> wx, <span class="type">double</span> wy, <span class="type">unsigned</span> <span class="type">int</span> &amp; mx, <span class="type">unsigned</span> <span class="type">int</span> &amp; my)</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mapToWorld</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> mx, <span class="type">unsigned</span> <span class="type">int</span> my, <span class="type">double</span> &amp; wx, <span class="type">double</span> &amp; wy)</span> <span class="type">const</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–åœ°å›¾å°ºå¯¸ä¿¡æ¯</span></span><br><span class="line">  <span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">getSizeInCellsX</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">getSizeInCellsY</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">double</span> <span class="title">getResolution</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">double</span> <span class="title">getOriginX</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">double</span> <span class="title">getOriginY</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–åŸå§‹ä»£ä»·æ•°ç»„</span></span><br><span class="line">  <span class="function"><span class="type">unsigned</span> <span class="type">char</span> * <span class="title">getCharMap</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<h5 id="layeredcostmap---åˆ†å±‚ç®¡ç†å™¨">3.3 LayeredCostmap - åˆ†å±‚ç®¡ç†å™¨</h5>
<p><code>LayeredCostmap</code> ç®¡ç†å¤šä¸ªä»£ä»·åœ°å›¾å±‚çš„ç»„åˆï¼Œå®šä¹‰åœ¨ <a href="nav2_costmap_2d/include/nav2_costmap_2d/layered_costmap.hpp">layered_costmap.hpp</a>ï¼š</p>
<p><strong>ä¸»è¦æˆå‘˜ï¼š</strong>
</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LayeredCostmap</span></span><br><span class="line">{</span><br><span class="line">  <span class="comment">// å­˜å‚¨æ‰€æœ‰å›¾å±‚æ’ä»¶</span></span><br><span class="line">  std::vector&lt;std::shared_ptr&lt;Layer&gt;&gt; plugins_;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æ˜¯å¦ä¸ºæ»šåŠ¨çª—å£æ¨¡å¼</span></span><br><span class="line">  <span class="type">bool</span> rolling_window_;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æœºå™¨äººå¤–å½¢è½®å»“</span></span><br><span class="line">  std::vector&lt;geometry_msgs::msg::Point&gt; footprint_;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<h4 id="ä»£ä»·å€¼å®šä¹‰">4. ä»£ä»·å€¼å®šä¹‰</h4>
<p>å®šä¹‰åœ¨ <a href="nav2_costmap_2d/include/nav2_costmap_2d/cost_values.hpp">cost_values.hpp</a>ï¼š</p>
<table>
<thead>
<tr>
<th>ä»£ä»·å€¼</th>
<th>å¸¸é‡å</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>FREE_SPACE</td>
<td>è‡ªç”±ç©ºé—´ï¼Œå¯å®‰å…¨é€šè¡Œ</td>
</tr>
<tr>
<td>1-252</td>
<td>-</td>
<td>ä¸åŒç¨‹åº¦çš„ä»£ä»·ï¼ˆè¶Šé«˜è¶Šå±é™©ï¼‰</td>
</tr>
<tr>
<td>253</td>
<td>INSCRIBED_INFLATED_OBSTACLE</td>
<td>å†…åˆ‡éšœç¢ç‰©ï¼ˆæ¥è§¦æœºå™¨äººå¤–æ¥åœ†ï¼‰</td>
</tr>
<tr>
<td>254</td>
<td>LETHAL_OBSTACLE</td>
<td>è‡´å‘½éšœç¢ç‰©ï¼ˆç»å¯¹ä¸å¯é€šè¿‡ï¼‰</td>
</tr>
<tr>
<td>255</td>
<td>NO_INFORMATION</td>
<td>æœªçŸ¥åŒºåŸŸ</td>
</tr>
</tbody>
</table>
<h4 id="æ’ä»¶å±‚ç³»ç»Ÿ">5. æ’ä»¶å±‚ç³»ç»Ÿ</h4>
<h5 id="é»˜è®¤æ’ä»¶é…ç½®">5.1 é»˜è®¤æ’ä»¶é…ç½®</h5>
<p>åœ¨ <code>costmap_2d_ros.cpp</code> ä¸­å®šä¹‰çš„é»˜è®¤æ’ä»¶ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">default_plugins_{<span class="string">"static_layer"</span>, <span class="string">"obstacle_layer"</span>, <span class="string">"inflation_layer"</span>},</span><br><span class="line">default_types_{</span><br><span class="line">  <span class="string">"nav2_costmap_2d::StaticLayer"</span>,</span><br><span class="line">  <span class="string">"nav2_costmap_2d::ObstacleLayer"</span>,</span><br><span class="line">  <span class="string">"nav2_costmap_2d::InflationLayer"</span>}</span><br></pre></td></tr></tbody></table></figure>
<h5 id="å„å±‚åŠŸèƒ½">5.2 å„å±‚åŠŸèƒ½</h5>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 33%">
<col style="width: 41%">
</colgroup>
<thead>
<tr>
<th>å›¾å±‚</th>
<th>æºæ–‡ä»¶</th>
<th>ä¸»è¦åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>StaticLayer</strong></td>
<td><a href="nav2_costmap_2d/plugins/static_layer.cpp">static_layer.cpp</a></td>
<td>å¤„ç†é™æ€åœ°å›¾æ•°æ®ï¼ˆä» map_server è®¢é˜…ï¼‰</td>
</tr>
<tr>
<td><strong>ObstacleLayer</strong></td>
<td><a href="nav2_costmap_2d/plugins/obstacle_layer.cpp">obstacle_layer.cpp</a></td>
<td>å¤„ç†ä¼ æ„Ÿå™¨å®æ—¶æ£€æµ‹åˆ°çš„åŠ¨æ€éšœç¢ç‰©</td>
</tr>
<tr>
<td><strong>InflationLayer</strong></td>
<td><a href="nav2_costmap_2d/plugins/inflation_layer.cpp">inflation_layer.cpp</a></td>
<td>å¯¹éšœç¢ç‰©è¿›è¡Œè†¨èƒ€å¤„ç†ï¼Œå¢åŠ å®‰å…¨è¾¹ç•Œ</td>
</tr>
<tr>
<td><strong>VoxelLayer</strong></td>
<td><a href="nav2_costmap_2d/plugins/voxel_layer.cpp">voxel_layer.cpp</a></td>
<td>3D ä½“ç´ å±‚ï¼Œæ”¯æŒå¤šå±‚éšœç¢ç‰©æ¸…é™¤</td>
</tr>
<tr>
<td><strong>RangeSensorLayer</strong></td>
<td><a href="nav2_costmap_2d/plugins/range_sensor_layer.cpp">range_sensor_layer.cpp</a></td>
<td>å¤„ç†è¶…å£°æ³¢ç­‰æµ‹è·ä¼ æ„Ÿå™¨æ•°æ®</td>
</tr>
</tbody>
</table>
<h4 id="æ•°æ®æµå›¾">6. æ•°æ®æµå›¾</h4>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">                    â”‚  map_server  â”‚</span><br><span class="line">                    â”‚  (é™æ€åœ°å›¾)   â”‚</span><br><span class="line">                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">                           â”‚</span><br><span class="line">                           â–¼</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚ LaserScan   â”‚â”€â”€â”€â”€â–¶â”‚              â”‚     â”‚              â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚ Costmap2DROS â”‚â”€â”€â”€â”€â–¶â”‚ PlannerServerâ”‚</span><br><span class="line">â”‚ PointCloud  â”‚â”€â”€â”€â”€â–¶â”‚              â”‚     â”‚              â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">                           â”‚</span><br><span class="line">                           â–¼</span><br><span class="line">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">                    â”‚ /costmap     â”‚</span><br><span class="line">                    â”‚ (å¯è§†åŒ–å‘å¸ƒ)  â”‚</span><br><span class="line">                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></tbody></table></figure>
<h4 id="å…³é”®å‚æ•°é…ç½®">7. å…³é”®å‚æ•°é…ç½®</h4>
<p>åœ¨ <a href="nav2_costmap_2d/src/costmap_2d_ros.cpp">costmap_2d_ros.cpp</a> ä¸­å£°æ˜çš„ä¸»è¦å‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>é»˜è®¤å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolution</code></td>
<td>0.1</td>
<td>åœ°å›¾åˆ†è¾¨ç‡ï¼ˆç±³/å•å…ƒæ ¼ï¼‰</td>
</tr>
<tr>
<td><code>width</code></td>
<td>5</td>
<td>åœ°å›¾å®½åº¦ï¼ˆç±³ï¼‰</td>
</tr>
<tr>
<td><code>height</code></td>
<td>5</td>
<td>åœ°å›¾é«˜åº¦ï¼ˆç±³ï¼‰</td>
</tr>
<tr>
<td><code>rolling_window</code></td>
<td>false</td>
<td>æ»šåŠ¨çª—å£æ¨¡å¼ï¼ˆlocal_costmap é€šå¸¸ä¸º trueï¼‰</td>
</tr>
<tr>
<td><code>global_frame</code></td>
<td>â€œmapâ€</td>
<td>å…¨å±€åæ ‡ç³»</td>
</tr>
<tr>
<td><code>robot_base_frame</code></td>
<td>â€œbase_linkâ€</td>
<td>æœºå™¨äººåæ ‡ç³»</td>
</tr>
<tr>
<td><code>update_frequency</code></td>
<td>5.0</td>
<td>æ›´æ–°é¢‘ç‡ï¼ˆHzï¼‰</td>
</tr>
<tr>
<td><code>publish_frequency</code></td>
<td>1.0</td>
<td>å‘å¸ƒé¢‘ç‡ï¼ˆHzï¼‰</td>
</tr>
<tr>
<td><code>footprint</code></td>
<td>-</td>
<td>æœºå™¨äººå¤–å½¢è½®å»“</td>
</tr>
</tbody>
</table>
<h5 id="local-costmap-vs-global-costmap">7.1 Local Costmap vs Global Costmap</h5>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Local Costmap</th>
<th>Global Costmap</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>åæ ‡ç³»</strong></td>
<td><code>odom</code></td>
<td><code>map</code></td>
</tr>
<tr>
<td><strong>æ»šåŠ¨çª—å£</strong></td>
<td><code>True</code></td>
<td><code>False</code></td>
</tr>
<tr>
<td><strong>å°ºå¯¸</strong></td>
<td>è¾ƒå°ï¼ˆå¦‚ 3mÃ—3mï¼‰</td>
<td>è¾ƒå¤§ï¼ˆè¦†ç›–æ•´ä¸ªåœ°å›¾ï¼‰</td>
</tr>
<tr>
<td><strong>æ›´æ–°é¢‘ç‡</strong></td>
<td>è¾ƒé«˜ï¼ˆå¦‚ 5Hzï¼‰</td>
<td>è¾ƒä½ï¼ˆå¦‚ 1Hzï¼‰</td>
</tr>
<tr>
<td><strong>ç”¨é€”</strong></td>
<td>å±€éƒ¨é¿éšœ</td>
<td>å…¨å±€è·¯å¾„è§„åˆ’</td>
</tr>
</tbody>
</table>
<h4 id="æ€»ç»“">8. æ€»ç»“</h4>
<p><code>nav2_costmap_2d</code> åŠŸèƒ½åŒ…çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ol type="1">
<li><strong>ç»Ÿä¸€çš„ç¯å¢ƒè¡¨ç¤º</strong>ï¼šå°†å¤šç§ä¼ æ„Ÿå™¨æ•°æ®èåˆä¸ºç»Ÿä¸€çš„ 2D ä»£ä»·åœ°å›¾</li>
<li><strong>åˆ†å±‚æ¶æ„è®¾è®¡</strong>ï¼šé€šè¿‡æ’ä»¶ç³»ç»Ÿæ”¯æŒçµæ´»çš„æ•°æ®æºç»„åˆ</li>
<li><strong>é«˜æ•ˆçš„åæ ‡è½¬æ¢</strong>ï¼šæä¾›ä¸–ç•Œåæ ‡ä¸åœ°å›¾åæ ‡çš„åŒå‘è½¬æ¢</li>
<li><strong>å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šä½œä¸º ROS2 LifecycleNode æä¾›å¯æ§çš„çŠ¶æ€ç®¡ç†</li>
<li><strong>ä¸ºå¯¼èˆªæœåŠ¡</strong>ï¼šä¸º <code>PlannerServer</code>ã€<code>ControllerServer</code> ç­‰ä¸Šå±‚æ¨¡å—æä¾›å¯é çš„ç¯å¢ƒä»£ä»·ä¿¡æ¯</li>
</ol>
<p>é€šè¿‡ <code>Costmap2DROS</code> å°è£…ï¼Œä¸Šå±‚æ¨¡å—æ— éœ€å…³å¿ƒå…·ä½“çš„ä¼ æ„Ÿå™¨ç±»å‹å’Œæ•°æ®æ ¼å¼ï¼Œåªéœ€æŸ¥è¯¢ä»£ä»·åœ°å›¾å³å¯è·å¾—ç¯å¢ƒçš„å®‰å…¨æ€§è¯„ä¼°ï¼Œè¿™æ˜¯ Navigation2 æ¶æ„è§£è€¦çš„å…³é”®æ‰€åœ¨ã€‚</p>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2026-01-30</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Stocks yuan</span>
            
            
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/ROS2/'>
                            ROS2
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                

                
                    <span class="post-footer-pre-next-last-span-right">ä¸‹ä¸€ç¯‡ï¼š<a href="/2026/01/27/Navigation2%E2%80%94%E2%80%94navfn-planner/">Navigation2â€”â€”navfn_planner</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>




                    

                    <div class="footer">
    
        <span> 
            Â© 2025 stocks-yuan 

            
                

            
        </span>
       
    
</div>



<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // å¯ç”¨æ’ä»¶
            thumbnail: true,          // æ˜¾ç¤ºç¼©ç•¥å›¾
            zoom: true,               // å¯ç”¨ç¼©æ”¾åŠŸ
            rotate: true,             // å¯ç”¨æ—‹è½¬åŠŸèƒ½èƒ½
            autoplay: true,        // å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½
            fullScreen: true,      // å¯ç”¨å…¨å±åŠŸèƒ½
            pager: false, //é¡µç ,
            zoomFromOrigin: true,   // ä»åŸå§‹ä½ç½®ç¼©æ”¾
            actualSize: true,       // å¯ç”¨æŸ¥çœ‹å®é™…å¤§å°çš„åŠŸèƒ½
            enableZoomAfter: 300,    // å»¶è¿Ÿç¼©æ”¾ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆåå¯ç¼©æ”¾
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // ä¿®å¤é€‰æ‹©å™¨
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>
<script src="/js/emojiHandler.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        wrapEmojis('.paper');
    });
</script>
